# Установка и обновление Linux. Основы администрирования
## 1. Установка ОС

Для выполнения задания была произведена установка VirtualBox - инструмент для виртуализации, создана виртуальная машина, произведена установка ОС Linux Ubuntu 20.04 Server LTS. Для получения информации о версии ОС выполнена команда:\
`cat /etc/issue`\
![part1](/src/misc/images/part1.png)
>Рисунок 1 Результат выполнения команды cat /etc/issue

## 2. Создание пользователя

Для создания нового пользователя с именем test_user_1, установки пароля qwerty и добавления в группу adm используется команда :\
`sudo useradd test_user_1 -p qwerty -G adm`\
![part2](/src/misc/images/part2.png)
>Рисунок 2. Результат выполнения команды cat /etc/passwd

## 3. Настройка сети ОС
### 3.1 Изменение названия машины

Для изменения названия машины на user-1 используется команда:\
`hostnamectl set-hostname user-1`\
![part3_1](/src/misc/images/part3_1.png)
>Рисунок 3.1 Отображение нового названия машины
### 3.2 Установка временной зоны

Для установки временной зоны, соответствующей текущему местоположению используется команда:\
`sudo timedatectl set-timezone Europe/Moscow`\
![part3_2](/src/misc/images/part3_2.png)
>Рисунок 3.2 Отображение актуальной временной зоны

### 3.3 Вывод названия сетевых интерфейсов

Для вывода названия сетевых интерфейсов используется команда:\
`ip -br link show`\
Наличие интерфейса lo объяснется использованием виртуального интерфейса, присутствующий по умолчанию в любом Linux. Используется для отладки сетевых программ и запуска серверных приложений на локальной машине.\
![part3_3](/src/misc/images/part3_3.png)
>Рисунок 3.3 Отображение названия сетевых интерфейсов

### 3.4 Вывод ip адреса устройства

Для получения ip адреса от DHCP - сервера используется команда:\
`sudo dhclient -v`\
DHCP - Dynamic Host Configuration Protocol\
![part3_4](/src/misc/images/part3_4.png)
>Рисунок 3.4 Отображение ip адреса устройства

### 3.5 Вывод внешнего и внутреннего ip адреса

Для определения внешнего и внутреннего ip адресов, соответственно используются команды:\
`curl ifconfig.me`\
`ip -br a`\
![part3_5_1](/src/misc/images/part3_5_1.png)
>Рисунок 3.5.1 Отображение внешнего ip адреса устройства

![part3_5_2](/src/misc/images/part3_5_2.png)
>Рисунок 3.5.2 Отображение внутреннего ip адреса устройства

### 3.6 Ручная конфигурация ip, gw, dns

Для задания статичных настроек ip, gw, dns необходимо внести изменения в файл /etc/netplan/00-installer-config.yaml.\
Исходное содержание файла:\
![part3_6_1](/src/misc/images/part3_6_1.png)
>Рисунок 3.6.1 Первоначальное содержание файла

Для запрета запроса адреса у dhcp сервера изменяется поле 'dhcp4' с значения 'true' на значение 'no'.\
Так как условиями задания не было установлено конкретное значение статического ip - адреса, то происходит выбор случайного, например - 10.0.2.23. Для этого добавляется поле 'adresses'.\
Для установки шлюза по умолчанию добавляется поле 'gateway4' с значением одного из возможных шлюзов. В рамках примера есть только один с адресом 10.0.2.2\
Для ручного выбора DNS-сервера добавляется поле 'nameserver' с возможностью обращения к серверу по ip установлением поля 'addresses' значением 1.1.1.1\
![part3_6_2](/src/misc/images/part3_6_2.png)
>Рисунок 3.6.2 Результат изменений конфигурационного файла

### 3.7 Проверка выполнения п. 3.6

Для проверки осуществляется перезагрузка виртуальной машины, использование утилиты 'ifconfig', пинг удаленных хостов 1.1.1.1 и ya.ru при помощи команд:\
`ping -c 8 1.1.1.1`\
`ping -c 8 ya.ru`\
![part3_7_1](/src/misc/images/part3_7_1.png)
>Рисунок 3.7.1 Результат использования утилиты 'ifconfig' после перезагрузки

![part3_7_2](/src/misc/images/part3_7_2.png)
>Рисунок 3.7.2 Результат использования утилиты 'ping' после перезагрузки

## 4. Обновление ОС

Для обновления системных пакетов ОС необходимо обновить их списки, для этого используется команда:\
`sudo apt-get update`\
![part4_1](/src/misc/images/part4_1.png)
>Рисунок 4.1 Результат обновления списка пакетов

Для обновления установленных пакетов используется команда:\
`sudo apt-get upgrade`

![part4_2](/src/misc/images/part4_2.png)
>Рисунок 4.2 Результат проверки необходимости обновления пакетов

## 5. Использование команды **sudo**

Команда sudo ( substitute user and do, подменить пользователя и выполнить ) позволяет строго определенным пользователям выполнять указанные программы с административными привилегиями без ввода пароля суперпользователя root. Если быть точнее, то команда sudo позволяет выполнять программы от имени любого пользователя, но, если идентификатор или имя этого пользователя не указаны, то предполагается выполнение от имени суперпользователя root.\
Чтобы поменять имя хоста от имени другого пользователя используется команда:\
`sudo -u test_user_1 hostnamectl set-hostname user-2`

![part5](/src/misc/images/part5.png)
>Рисунок 5 Cмена имени хоста от имени пользователя test_user_1

## 6. Установка и настройка службы времени

Для вывода времени и часового пояса используется команда:\
`timedatectl show`

![part6](/src/misc/images/part6.png)
>Рисунок 6 Вывод времени, часового пояса

## 7. Установка и использование текстовых редакторов

Для удобства с помощью команды `mkdir` создается директория ~/Documents/text_editors\
Далее при помощи команды `touch` последовательно создается три файла: test_vim.txt, test_nano.txt, test_joe.txt.Последовательность команд для выхода из файла с сохранением:\
-vim
1. esc
2. shift + :
3. wq

-nano
1. Ctrl+x
2. y

-joe
1. ctrl+K
2. q
3. y

![part7_1_1](/src/misc/images/part7_1_1.png)
>Рисунок 7.1.1 Использование редактора vim

![part7_1_2](/src/misc/images/part7_1_2.png)
>Рисунок 7.1.2 Использование редактора nano

![part7_1_3](/src/misc/images/part7_1_3.png)
>Рисунок 7.1.3 Использование редактора joe

Последовательность команд для выхода из файла без сохранения:\
-vim
1. esc
2. shift + :
3. q!

-nano
1. Ctrl+x
2. n

-joe
1. ctrl+K
2. q
3. n

![part7_2_1](/src/misc/images/part7_2_1.png)
>Рисунок 7.2.1 Выход без сохранения из редактора vim

![part7_2_2](/src/misc/images/part7_2_2.png)
>Рисунок 7.2.2 Выход без сохранения из редактора nano

![part7_2_3](/src/misc/images/part7_2_3.png)
>Рисунок 7.2.3 Выход без сохранения из редактора joe

![part7_3_1](/src/misc/images/part7_3_1.png)
>Рисунок 7.3.1 Поиск слова в vim

![part7_3_2](/src/misc/images/part7_3_2.png)
>Рисунок 7.3.2 Замена слова в vim

![part7_3_3](/src/misc/images/part7_3_3.png)
>Рисунок 7.3.3 Поиск слова в nano

![part7_3_4](/src/misc/images/part7_3_4.png)
>Рисунок 7.3.4 Замена слова в nano

![part7_3_5](/src/misc/images/part7_3_5.png)
>Рисунок 7.3.5 Поиск слова в joe

![part7_3_6](/src/misc/images/part7_3_6.png)
>Рисунок 7.3.6 Замена слова в joe

## 8. Установка и базовая настройка сервиса **SSHD**

Установка службы SSHd:\
`sudo apt install openssh-server`

Добавление службы в автозагрузку:\
`sudo systemctl enable ssh`

![part8_1](/src/misc/images/part8_1.png)
>Рисунок 8.1 Установка порта 2022

Для сохранения изменений необходимо перезапустить службу:\
`sudo systemctl restart ssh`

Для поиска процесса sshd и информации о нем используется команда:\
`ps -Af | grep sshd`
где флаг -А выбирает все процессы, а флаг -f выводит максимальное количество данных о процессах.

![part8_2](/src/misc/images/part8_2.png)
>Рисунок 8.2 Вывод информации о процессе sshd

Для вывода всех tcp портов используется команда:\
`netstat -tan`

![part8_3](/src/misc/images/part8_3.png)
>Рисунок 8.3 Вывод информации о всех tcp портах

Флаг -a выводит список всех портов.\
Флаг -t выводит список всех tcp соединений.\
Флаг -n выводит адреса в численном виде.\
Proto — название протокола.\
Recv-Q — количество байтов, помещённых в буфер приёма TCP/IP, но не переданных приложению.\
Send-Q — количество байтов, помещённых в буфер отправки TCP/IP, но не отправленных, или отправленных, но не подтверждённых.\
Local Address:Port — локальный адрес и порт сервера.\
Foreign Address:Port — адрес и порт клиента.\
State - состояние соединения.\
Адрес 0.0.0.0 спользуется на серверах для обозначения того, что служба может связываться со всеми сетевыми интерфейсами. Он указывает серверу "слушать" и принимать соединения с любого IP-адреса.

## 9. Установка и использование утилит **top**, **htop**

### 9.1 Использование утилиты top

С помощью команды `top` определено:\
Uptime — 59 минут;\
Количество авторизованных пользователей — 1;\
Общая загрузка системы — 0.00 минуту назад, 0.00 5 минут назад и 0.00 15 минут назад;\
Общее количество процессов — 102;\
Загрузка cpu — 3%;\
Загрузка памяти — 151.9 Мб используется, 332.9 Мб кэшировано;\
PID процесса, занимающего больше всего памяти — 1;\
PID процесса, занимающего больше всего процессорного времени — 1317.

![part9_1](/src/misc/images/part9_1.png)
>Рисунок 9.1 Вывод информации о процессах

### 9.2 Использование утилиты htop

![part9_2](/src/misc/images/part9_2.png)
>Рисунок 9.2 Сортировка по PID

![part9_3](/src/misc/images/part9_3.png)
>Рисунок 9.3 Сортировка по PERCENT_CPU

![part9_4](/src/misc/images/part9_4.png)
>Рисунок 9.4 Сортировка по PERCENT_MEM

![part9_5](/src/misc/images/part9_5.png)
>Рисунок 9.5 Сортировка по TIME

![part9_6](/src/misc/images/part9_6.png)
>Рисунок 9.6 Фильтр по sshd

![part9_7](/src/misc/images/part9_7.png)
>Рисунок 9.7 Поиск процессов syslog

![part9_8](/src/misc/images/part9_8.png)
>Рисунок 9.8 С выводом информации hostname, clock, uptime

## 10. Использование утилиты **fdisk**

Название жесткого диска — VBOX HARDDISK;\
Размер — 32 GiB;\
Количество секторов — 67108864;\
Размер swap — 0.

## 11. Использование утилиты **df**

### 11.1 Использование без флагов

Для корневого раздела (/):\
Размер раздела — 15 371 208;\
Размер занятого пространства — 6 424 976;\
Размер свободного пространства — 8 143 624;\
Процент использования — 45%;\
Единица измерения — килобайты.

### 11.2 Использование с флагами -Th

Для корневого раздела (/):\
Размер раздела — 15G;\
Размер занятого пространства — 6.2G;\
Размер свободного пространства — 7.8G;\
Процент использования — 45%;\
Файловая система — ext4.

## 12. Использование утилиты **du**

![part12_1](/src/misc/images/part12_1.png)
>Рисунок 12.1 Вывод размера папки /home

![part12_2](/src/misc/images/part12_2.png)
>Рисунок 12.2 Вывод размера папки /var

![part12_3](/src/misc/images/part12_3.png)
>Рисунок 12.3 Вывод размера папки /var/log

![part12_4](/src/misc/images/part12_4.png)
>Рисунок 12.4 Вывод размера содержимого папки /var/log

## 13. Установка и использование утилиты **ncdu**

![part13_1](/src/misc/images/part13_1.png)
>Рисунок 13.1 Вывод размера папок /home и /var

![part13_2](/src/misc/images/part13_2.png)
>Рисунок 13.2 Вывод размера папки /var/log

## 14. Работа с системными журналами

Время последней успешной авторизации — Sep 21 16:53:03;\
Имя пользователя — septicge;\
Метод входа в систему — LOGIN.

![part14_1](/src/misc/images/part14_1.png)
>Рисунок 14.1 Лог рестарта службы sshd
## Часть 15. Использование планировщика заданий **CRON**

Планирование задания uptime каждый 2 минуты:\
`crontab -e`

![part15_1](/src/misc/images/part15_1.png)
>Рисунок 15.1 Редактирование crontab

Вывод списка текущих задач:\
`crontab -l`

![part15_2](/src/misc/images/part15_2.png)
>Рисунок 15.2 Вывод списка текущих задач

![part15_3](/src/misc/images/part15_3.png)
>Рисунок 15.3 Вывод строки выполнения задачи uptime

Удаление всех заданий из планировщика:\
`crontab -r`

![part15_4](/src/misc/images/part15_4.png)
>Рисунок 15.4 Повторный вывод списка текущих задач
